# 为什么我在前端项目中引入 Domain / Widget 分层（而不是只有 Components）

在大多数前端项目中，工程结构通常止步于：

> **components + pages**

在业务简单时，这种结构是足够的；
但在**金融类、复杂业务系统**中，它往往会在中后期逐渐失效。

本文记录我在实际项目中，**为什么选择引入 Domain / Widget 分层**，以及这种选择解决了什么问题。

---

## 一、问题背景：组件复用 ≠ 业务复用

在项目早期，我们往往以“组件复用”为目标：

- Button / Table / Form
- Modal / Drawer
- 一些组合型 UI

但随着业务发展，我逐渐意识到一个问题：

> **真正被多个产品反复使用的，并不是 UI 组件，而是“业务场景”。**

例如在金融系统中：

- 风控提示卡片
- 合规说明面板
- PV / 客服聊天模块
- KYC 进度展示

这些模块：

- 有 UI
- 有样式
- 有明确业务语义
- 会被多个产品 / 页面复用

但它们**既不是纯 UI 组件，也不是完整页面**。

---

## 二、只有 Components 架构会如何退化

如果坚持只用 components 层来承载这些能力，系统通常会出现以下演化路径：

### 1️⃣ 组件逐渐“变脏”

- 大量 props
- if / else 分支
- 针对不同产品的条件判断

组件从“展示单元”变成了“业务承载体”。

---

### 2️⃣ 业务规则被复制

- 权限判断写在多个组件里
- 风控条件分散在 UI 中

一旦规则变更，很难保证一致性。

---

### 3️⃣ 复用名存实亡

最终的结果往往是：

- 组件被 fork
- 复制粘贴
- 不同产品维护不同版本

此时“复用”只剩下名字。

---

## 三、我引入的两层新抽象：Domain 与 Widget

为了解决上述问题，我在前端工程中引入了两层新的抽象。

---

## 四、Domain：业务事实与规则

### Domain 是什么

Domain 用于描述：

- 稳定的业务事实
- 不依赖 UI 的业务规则

例如：

- 用户身份与角色
- 权限判断
- 风控规则
- 授信条件

### Domain 的特征

- ❌ 没有 UI
- ❌ 不关心交互形式
- ✅ 在多个产品中必须保持一致

> **Domain 的职责是保证“业务是否正确”。**

---

## 五、Widget：可嵌入的业务场景模块

### Widget 是什么

Widget 用于承载：

- 一个完整但局部的业务场景
- 带 UI + 样式 + 交互
- 可被多个产品嵌入

例如：

- PV 聊天卡片
- 风险提示模块
- 合规说明弹窗

### Widget 的特征

- ✅ 有 UI
- ✅ 有样式
- ✅ 有明确业务语义
- ❌ 不负责路由
- ❌ 不负责产品流程

> **Widget 的职责是保证“业务如何被用户感知”。**

---

## 六、为什么 Domain / Widget 要分离

这两层关注的是**完全不同的问题**：

| 层级 | 关注点 |
|----|----|
| Domain | 业务是否正确 |
| Widget | 业务如何呈现 |

将它们混在一起，会导致：

- 规则分散
- UI 过载
- 难以维护

---

## 七、一个典型金融案例

以“PV 聊天模块”为例：

- 是否允许聊天 → **Domain 规则**
- 聊天 UI / 交互 → **Widget**
- 鉴权 / API / 埋点 → **Adapter / App 层**

通过这种拆分：

- UI 不感知产品差异
- 规则不被复制
- 产品差异被限制在最外层

---

## 八、这种结构带来的收益

### 1️⃣ 业务一致性

- 规则集中
- 行为可审计

---

### 2️⃣ 可控的复杂度

- 复杂度存在
- 但不会向 UI 扩散

---

### 3️⃣ 更真实的复用

- 复用的是“业务语义”
- 而不仅是 JSX 结构

---

## 九、这不是银弹

需要说明的是：

- 不是所有项目都需要 Domain / Widget
- 简单 CRUD 项目完全可以只用 components

但在以下场景中，它非常有价值：

- 多产品
- 金融 / 风控 / 合规
- 生命周期长

---

## 十、总结

> **Components 解决的是“怎么展示”，
> Domain / Widget 解决的是“展示什么、为什么这样展示”。**

引入 Domain / Widget 分层，不是为了复杂而复杂，
而是为了在复杂业务中，**延缓系统退化的速度**。

这是我在实际项目中，做出的一个工程取舍。
